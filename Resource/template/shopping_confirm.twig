{% if Order.Payment.getMethodClass == 'Plugin\\UnivaPayPlugin\\Service\\Method\\CreditCard' %}
<script src="https://other-widget.gyro-n.money/client/checkout.js"></script>
<script>
    form = document.querySelector("#shopping-form");
    checkout = UnivapayCheckout.create({
        appId: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhcHBfdG9rZW4iLCJpYXQiOjE2MjgxNTk4NDksIm1lcmNoYW50X2lkIjoiMTFlYjljMGUtZjk2Zi04NzE4LWI4ZjQtM2JlZWZhMjQ3ZTRiIiwic3RvcmVfaWQiOiIxMWViOWMwZi00NDgxLTg1NmMtYWQzOS1mMzZmNGEwZDZlMDgiLCJkb21haW5zIjpbIioiXSwibW9kZSI6InRlc3QiLCJjcmVhdG9yX2lkIjoiMTFlYjljMGUtZjk2Zi04NzE4LWI4ZjQtM2JlZWZhMjQ3ZTRiIiwidmVyc2lvbiI6MSwianRpIjoiMTFlYmY1ZDktMjFmYS1iYTIyLTk3ZDEtMjFhOWYwMzUzNjFkIn0.KX22rkeffVMu7C2CxsATSyBjXgK3BTTGQcLNaFLL9cw",
        checkout: "payment",
        amount: 1,
        currency: "jpy",
        autoClose: true,
        onSuccess: (result) => {
            console.log(result);
            form.submit();
        },
        onError: () => {
            alert("エラーが発生しました。サイト管理者にお問い合わせください。");
            window.history.back(-1);
        },
        closed: () => {
            alert("決済が中断されました");
            window.history.back(-1);
        }
    });
    form.addEventListener("submit", () => {
        event.preventDefault();
        checkout.open();
    });
</script>
{% endif %}
